var elevateGoogleAuthWindow,elevateProgressBar=0;function elevateOverlay(e){jQuery("body").append('<div class="elevate-overlay"><div class="overlay-inside"><i class="close fa fa-times"> </i> '+e+"</div></div>"),jQuery(".overlay-inside").click(function(e){e.stopPropagation()}),jQuery(".elevate-overlay").click(function(e){e.preventDefault(),jQuery(this).remove()})}function elevateHandleUploads(){jQuery("button.upload").each(function(){var i=jQuery(this),s=jQuery(this).attr("data-name");jQuery("#wpwrap").append('<div class="upload-hide"><form method="POST" id="'+s+'_form" action="/" id="'+s+'_form"><input type="FILE" id="'+s+'" name="'+s+'_file" /><input type="hidden" name="file_key" value="'+s+'_file" /><input type="submit" id="'+s+'_submit" name="'+s+'_submit" /></form></div>');jQuery("form#"+s+"_form").submit(function(e){var a=jQuery("form#"+s+"_form").get(0),t=new FormData(a);t.append("action","elevate_ajax"),t.append("elevate_action","file_upload"),t.append("elevate_nonce",ElevateData.elevate_nonce),t.append("acceptable_types","image/png,image/jpeg,image/jpeg"),jQuery.ajax({url:ElevateData.admin_ajax,type:"POST",data:t,contentType:!1,cache:!1,processData:!1,success:function(e){var a=jQuery.parseJSON(e);0==a.code?(jQuery("input[name=elevate_"+s+"]").val(a.body.file_name),jQuery("a[data-name="+s+"]").attr("href",a.body.full_file_url),i.hide(),jQuery(".upload_"+s+" .image-wrapper").html('<img src="'+a.body.full_file_url+'" />'),jQuery("#"+s+"_reset").show()):"invalid_mime_type"==a.error?alert(ElevateData.msg_invalid_mime):alert("Failed!")}}),e.preventDefault()}),jQuery("input[name=elevate_"+s+"]").val().length?i.hide():(i.show(),jQuery("input[name=elevate_"+s+"]").hide(),jQuery("#"+s+"_reset").hide()),jQuery("#"+s+"_reset").click(function(e){var a=jQuery(this).attr("data-name");jQuery("input[name=elevate_"+a+"]").val(""),jQuery(".upload_"+a+" .image-wrapper").html(""),e.preventDefault(),i.show(),jQuery("input[name=elevate_"+a+"]").hide(),jQuery("#"+a+"_reset").hide()})}),jQuery("button.upload").click(function(e){e.preventDefault();var a=jQuery(this).attr("data-name");jQuery("#"+a).click().on("change",function(e){jQuery("#"+a+"_submit").click()})})}function elevateCheckServices(a){if(jQuery(".google-services").length){elevateAdminAjax("check_all_services",{},function(e){a(e)})}}function elevateHandleWizard(e,a,t,i,s,r){jQuery(".site-setup li").hide();var l=0;a&&(l+=8),t&&(l+=1),i&&(l+=1);var d=s/l;if(0!=elevateProgressBar){var n=100*d;elevateProgressBar.animate(d,function(){elevateProgressBar.setText(n.toFixed(0).toString()+"%")})}switch(0==elevateProgressBar&&(elevateProgressBar=new ProgressBar.SemiCircle("#pb",{color:"#7c7",trailColor:"#ddd",duration:300,easing:"easeInOut",strokeWidth:5,trailWidth:2,text:{value:"0%"},alignToBottom:!0})),e){case 1:jQuery("li.generate-sitemap").addClass("active").fadeIn(),elevateAdminAjax("generate_sitemap",{},function(e){JSON.parse(e).code==ElevateData.ajax_success&&(jQuery("li.generate-sitemap").addClass("success").find("i").addClass("flip"),a?elevateHandleWizard(2,a,t,i,1,r):t?elevateHandleWizard(9,a,t,i,1,r):i&&elevateHandleWizard(10,a,t,i,1,r))});break;case 2:jQuery("li.check-sc-site").addClass("active").fadeIn(),elevateAdminAjax("google_check_sites",{},function(e){JSON.parse(e).code==ElevateData.ajax_success?(jQuery("li.check-sc-site").addClass("success").find("i").addClass("flip"),elevateHandleWizard(4,a,t,i,s+2,r)):(jQuery("li.check-sc-site").addClass("fail").find("i").addClass("flip"),jQuery("li.add-sc-site").fadeIn(),elevateHandleWizard(3,a,t,i,s+1,r))});break;case 3:jQuery("li.add-sc-site").addClass("active").fadeIn(),elevateAdminAjax("google_add_site",{},function(e){JSON.parse(e).code==ElevateData.ajax_success?(jQuery("li.add-sc-site").addClass("success").find("i").addClass("flip"),jQuery("li.check-sc-site").removeClass("fail").find("i").removeClass("flip"),jQuery("li.check-sc-site").addClass("success").find("i").addClass("flip"),elevateHandleWizard(4,a,t,i,s+1,r)):jQuery("li.add-sc-site").addClass("fail").find("i").addClass("flip")});break;case 4:jQuery("li.check-verification").addClass("active").fadeIn(),elevateAdminAjax("check_site_verification",{},function(e){JSON.parse(e).code==ElevateData.ajax_success?(jQuery("li.verify-site").addClass("success").find("i").addClass("flip"),elevateHandleWizard(6,a,t,i,s+2,r)):elevateHandleWizard(5,a,t,i,s+1,r)});break;case 5:jQuery("li.verify-site").addClass("active").fadeIn(),elevateAdminAjax("verify_site",{},function(e){JSON.parse(e).code==ElevateData.ajax_success?(jQuery("li.verify-site").addClass("success").find("i").addClass("flip"),elevateHandleWizard(6,a,t,i,s+1,r)):(jQuery("li.verify-site").addClass("fail").find("i").addClass("flip"),jQuery("#config-error").popup({opacity:.3,autoopen:!0,transition:"all 0.3s",onclose:function(){t?elevateHandleWizard(9,a,t,i,s+4,r):i?elevateHandleWizard(10,a,t,i,s+5,r):elevateHandleWizard(50,a,t,i,l,r)}}))});break;case 6:jQuery("li.check-sitemap").addClass("active").fadeIn(),elevateAdminAjax("check_sitemap",{},function(e){JSON.parse(e).code==ElevateData.ajax_success?(jQuery("li.check-sitemap").addClass("success").find("i").addClass("flip"),t?elevateHandleWizard(9,a,t,i,s+3,r):i&&elevateHandleWizard(10,a,t,i,s+4,r)):(jQuery("li.check-sitemap").addClass("fail").find("i").addClass("flip"),elevateHandleWizard(8,a,t,i,s+1,r))});break;case 8:jQuery("li.add-sitemap").addClass("active").fadeIn(),elevateAdminAjax("add_sitemap",{},function(e){JSON.parse(e).code==ElevateData.ajax_success?(jQuery("li.add-sitemap").addClass("success").find("i").addClass("flip"),jQuery("li.check-sitemap").removeClass("fail").find("i").removeClass("flip"),jQuery("li.check-sitemap").addClass("success").find("i").addClass("flip"),t?elevateHandleWizard(9,a,t,i,s+1,r):i?elevateHandleWizard(10,a,t,i,s+2,r):elevateHandleWizard(50,a,t,i,l,r)):(jQuery("li.add-sitemap").addClass("fail").find("i").addClass("flip"),jQuery.confirm({title:ElevateData.msg_setup_error_title,content:ElevateData.msg_setup_cant_add_sitemap,type:"blue",typeAnimated:!0,buttons:{close:function(){t?elevateHandleWizard(9,a,t,i,s+1,r):i?elevateHandleWizard(10,a,t,i,s+2,r):elevateHandleWizard(50,a,t,i,l,r)}},useBootstrap:!1}))});break;case 9:jQuery("li.create-analytics-property").addClass("active").fadeIn(),elevateAdminAjax("create_analytics_property",{},function(e){JSON.parse(e).code==ElevateData.ajax_success?jQuery("li.create-analytics-property").addClass("success").find("i").addClass("flip"):jQuery("li.create-analytics-property").addClass("fail").find("i").addClass("flip"),i?elevateHandleWizard(10,a,t,i,s+1,r):elevateHandleWizard(50,a,t,i,l,r)});break;case 10:jQuery("li.add-analytics-code").addClass("active").fadeIn(),elevateAdminAjax("add_analytics_code",{},function(e){JSON.parse(e).code==ElevateData.ajax_success?jQuery("li.add-analytics-code").addClass("success").find("i").addClass("flip"):jQuery("li.add-analytics-code").addClass("fail").find("i").addClass("flip"),elevateHandleWizard(50,a,t,i,l,r)});break;case 50:jQuery("li.complete").addClass("active").fadeIn(),r()}}function elevateSaveWizardState(){var e=jQuery("#elevate_wizard_language").val(),a=jQuery("#elevate_site_title").val(),t=jQuery("#elevate_site_name").val(),i=jQuery("#elevate_home_title").val(),s=jQuery("#elevate_site_description").val(),r=jQuery("#elevate_social_twitter_name").val(),l=jQuery("#elevate_bing_auth_code").val(),d=jQuery("#elevate_facebook_default_image").val();"auto"==e&&ElevateData.wp_locale,elevateAdminAjax("wizard_save_state",{settings:{site_title:a,selected_locale:e,site_name:t,home_title:i,home_desc:s,social_twitter_name:r,bing_auth_code:l,facebook_default_image:d}},function(e){})}function elevateInitialize(){function d(e){e?jQuery(".actions li").addClass("disabled"):jQuery(".actions li").removeClass("disabled")}var e=jQuery("#elevate-wizard");if(e){var a=0;jQuery("#elevate-wizard section").each(function(){jQuery(this).attr("data-pos",a),a+=1});var n=0,o=0,c=(parseInt(jQuery("section.intro").attr("data-pos")),parseInt(jQuery("section.basics").attr("data-pos")),parseInt(jQuery("section.site-name").attr("data-pos")),parseInt(jQuery("section.home-title").attr("data-pos")),parseInt(jQuery("section.description").attr("data-pos"))),u=parseInt(jQuery("section.branding").attr("data-pos")),y=(parseInt(jQuery("section.preview").attr("data-pos")),parseInt(jQuery("section.google-services").attr("data-pos"))),v=parseInt(jQuery("section.google-services-config").attr("data-pos")),p=parseInt(jQuery("section.site-setup").attr("data-pos")),f=parseInt(jQuery("section.done").attr("data-pos")),t=(jQuery("section.wizard-news").attr("data-pos"),0);function j(){jQuery(".google-services").length&&(n||(d(!0),elevateCheckServices(function(e){d(!1);var a=jQuery.parseJSON(e);setTimeout(function(){jQuery("#services-checking").hide(),a.body.has_google_analytics?(jQuery("#services-found").fadeIn(),jQuery("#services-checked li div").addClass("checked")):(jQuery("#services-missing").fadeIn(),jQuery("#config-search-console").addClass("checked"),jQuery("#config-add-analytics, #config-install-analytics").addClass("disabled")),n=!0},500)})))}void 0!==ElevateData.post_oauth_skip&&ElevateData.post_oauth_skip&&(t=y),e.steps({startIndex:t,headerTag:"h3",titleTemplate:'<span class="number">#index#</span> #title#',bodyTag:"section",transitionEffect:"slideLeft",autoFocus:!0,onInit:function(e,a){jQuery(".elevate #elevate-wizard").fadeIn(200),t==y&&j(),jQuery(".steps li").prepend('<div class="connector"><div class="dot"></div></div>')},onFinished:function(e,a){elevateAdminAjax("wizard_done",{},function(e){window.location.href=ElevateData.settings_general_page})},onStepChanging:function(e,a,t){if(elevateSaveWizardState(),a==y)return!jQuery(".google-services").length||n;if(a==v);else{if(a==v+1)return o;if(a==c){jQuery("#elevate_site_name").val();var i=jQuery("#elevate_home_title").val(),s=jQuery("#elevate_site_description").val();jQuery("#google-title").html(i),jQuery("#google-desc").html(s)}else if(a==u){var r=jQuery(".branding .image-wrapper img");if(r.length){var l=r.attr("src");l.length?jQuery("#google-image").css("background",'url("'+l+'")').show():jQuery("#google-image").css("background","inherit").hide()}else jQuery("#google-image").hide()}}return!0},onStepChanged:function(e,a,t){if(a==y)j();else if(a==p&&void 0!==ElevateData.has_tokens){var i=jQuery("#config-search-console").hasClass("checked"),s=jQuery("#config-add-analytics").hasClass("checked"),r=jQuery("#config-install-analytics").hasClass("checked");o||(d(!0),elevateHandleWizard(1,i,s,r,0,function(){d(!(o=!0))}))}else if(a==f){var l=jQuery("#elevate_wizard_email").val();l&&elevateAdminAjax("subscribe_mailing_list",{email:l},function(e){})}}})}Opentip.defaultStyle="dark",elevateHandleUploads();var i=jQuery.parseJSON(ElevateData.default_image);i.length&&(jQuery(".branding button.upload").hide(),jQuery(".branding button.remove").show(),jQuery(".branding a.link").attr("href",jQuery.parseJSON(ElevateData.default_image_url)),jQuery(".branding input[type=text]").val(i),jQuery(".branding .image-wrapper").html('<img src="'+jQuery.parseJSON(ElevateData.default_image_url)+'" />')),jQuery("#elevate_bing_auth_code").on("paste",function(e){elevateSaveWizardState()}),jQuery("#elevate_bing_auth_code").on("blur",function(e){elevateSaveWizardState()}),jQuery(".google-services-config div li div").click(function(e){jQuery(this).hasClass("disabled")||(jQuery(this).hasClass("checked")?jQuery(this).removeClass("checked"):jQuery(this).addClass("checked")),e.preventDefault()}),jQuery("#elevate_search_console_deactivate").click(function(e){elevateAdminAjax("revoke_all_tokens",{},function(e){window.location.href=window.location.href}),e.preventDefault()}),jQuery("#elevate_search_console_activate").click(function(e){window.location.href=ElevateData.oauth_auth_url,e.preventDefault()}),jQuery("#elevate_show_wizard_again").click(function(e){elevateAdminAjax("show_wizard",{},function(e){window.location.href=ElevateData.settings_wizard_page}),e.preventDefault()}),jQuery("#elevate_reset_all_settings").click(function(e){elevateAdminAjax("reset_settings",{},function(e){window.location.href=ElevateData.settings_wizard_page}),e.preventDefault()}),jQuery(".elevate #dashboard").length&&(elevateAdminAjax("get_dashboard_data",{},function(e){var a=jQuery.parseJSON(e),t=a.body.search_analytics.clicks;t||(t=0),1==ElevateData.has_google_tokens&&(jQuery(".crawl-errors").html(a.body.crawl_errors.count),jQuery(".clicks").html(t)),jQuery(".impressions").html(a.body.search_analytics.impressions),jQuery(".crawl-info .not-found").html(a.body.crawl_errors.not_found),jQuery(".crawl-info .not-auth").html(a.body.crawl_errors.permissions),jQuery(".crawl-info .server-error").html(a.body.crawl_errors.server_error),jQuery(".search-info .click-rate").html(a.body.search_analytics.ctr),jQuery(".search-info .position").html(a.body.search_analytics.position),a.body.has_analytics_installed?jQuery(".analytics-installed").html(jQuery(".analytics-installed").attr("data-tracking")):jQuery(".analytics-installed").html(jQuery(".analytics-installed").attr("data-not-tracking")),1==a.body.is_site_verified?jQuery(".site-verify").html(jQuery(".site-verify").attr("data-verified")):jQuery(".site-verify").html(jQuery(".site-verify").attr("data-not-verified")),a.body.sitemap_info.has_sitemap?a.body.sitemap_info.is_generating?(jQuery(".sitemap-generated").html(jQuery(".sitemap-generated").attr("data-generating")),jQuery(".last-modified").html(jQuery(".sitemap-generated").attr("data-pending")),jQuery(".sitemap-entries").html(jQuery(".sitemap-generated").attr("data-pending"))):(jQuery(".sitemap-generated").html(jQuery(".sitemap-generated").attr("data-generated")),jQuery(".last-modified").html(a.body.sitemap_info.modified_time),jQuery(".sitemap-entries").html(a.body.sitemap_info.entries)):(jQuery(".sitemap-generated").html(jQuery(".sitemap-generated").attr("data-not-generated")),jQuery(".last-modified").html(jQuery(".last-modified").attr("data-none")),jQuery(".sitemap-entries").html(jQuery(".last-modified").attr("data-none")))}),elevateAdminAjax("get_dashboard_data_speed",{},function(e){var a=jQuery.parseJSON(e);jQuery(".desktop-speed").html(a.body.desktop.speed),jQuery(".mobile-speed").html(a.body.mobile.speed),jQuery(".speed-info .desktop-size").html(a.body.desktop.response_bytes),jQuery(".speed-info .mobile-size").html(a.body.mobile.response_bytes);var t=(a.body.desktop.speed+a.body.mobile.speed)/2;jQuery(".speed-info .average-speed").html(t.toFixed(1))}))}jQuery(document).ready(function(){elevateInitialize()});